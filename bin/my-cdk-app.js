"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = require("aws-cdk-lib");
const DBstack_1 = require("../lib/DBstack"); // Import your DBStack
const api_stack_1 = require("../lib/api-stack"); // Import your APIStack
const frontend_deployment_stack_1 = require("../lib/frontend-deployment-stack");
const opensearch_stack_1 = require("../lib/opensearch_stack");
const bedrock_stack_1 = require("../lib/bedrock_stack");
const index_stack_1 = require("../lib/index_stack");
const app = new cdk.App();
// Create the DBStack
const dbStack = new DBstack_1.DBStack(app, "Unity-DBStack", {
    env: {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: process.env.CDK_DEFAULT_REGION || 'us-east-1'
    }
});
const openSearchStack = new opensearch_stack_1.OpenSearchStack(app, 'Unity-OpenSearchStack', {
    env: {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: process.env.CDK_DEFAULT_REGION || 'us-east-1'
    }
});
const indexStack = new index_stack_1.IndexStack(app, 'Unity-IndexStack', {
    openSearchStack,
    env: {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: process.env.CDK_DEFAULT_REGION || 'us-east-1'
    }
});
const bedrockStack = new bedrock_stack_1.BedrockStack(app, 'Unity-BedrockStack', {
    openSearchStack,
    indexStack,
    dbStack,
    env: {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: process.env.CDK_DEFAULT_REGION || 'us-east-1'
    }
});
indexStack.addDependency(openSearchStack);
bedrockStack.addDependency(indexStack);
// Create the APIStack, passing in the DBStack as a dependency
new api_stack_1.APIStack(app, "Unity-APIStack", {
    dbStack,
    bedrockStack,
    env: {
        account: process.env.CDK_DEFAULT_ACCOUNT,
        region: process.env.CDK_DEFAULT_REGION || 'us-east-1'
    }
});
new frontend_deployment_stack_1.FrontendDeploymentStack(app, "Unity-FrontendDeploymentStack");
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXktY2RrLWFwcC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm15LWNkay1hcHAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtQ0FBa0M7QUFDbEMsNENBQXlDLENBQUMsc0JBQXNCO0FBQ2hFLGdEQUE0QyxDQUFDLHVCQUF1QjtBQUNwRSxnRkFBMkU7QUFDM0UsOERBQTBEO0FBQzFELHdEQUFvRDtBQUNwRCxvREFBZ0Q7QUFFaEQsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7QUFFMUIscUJBQXFCO0FBQ3JCLE1BQU0sT0FBTyxHQUFHLElBQUksaUJBQU8sQ0FBQyxHQUFHLEVBQUUsZUFBZSxFQUFFO0lBQ2hELEdBQUcsRUFBRTtRQUNILE9BQU8sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQjtRQUN4QyxNQUFNLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsSUFBSSxXQUFXO0tBQ3REO0NBQ0YsQ0FBQyxDQUFDO0FBRUgsTUFBTSxlQUFlLEdBQUcsSUFBSSxrQ0FBZSxDQUFDLEdBQUcsRUFBRSx1QkFBdUIsRUFBRTtJQUN4RSxHQUFHLEVBQUU7UUFDSCxPQUFPLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUI7UUFDeEMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0JBQWtCLElBQUksV0FBVztLQUN0RDtDQUNGLENBQUMsQ0FBQztBQUVILE1BQU0sVUFBVSxHQUFHLElBQUksd0JBQVUsQ0FBQyxHQUFHLEVBQUUsa0JBQWtCLEVBQUU7SUFDekQsZUFBZTtJQUNmLEdBQUcsRUFBRTtRQUNILE9BQU8sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQjtRQUN4QyxNQUFNLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsSUFBSSxXQUFXO0tBQ3REO0NBQ0YsQ0FBQyxDQUFDO0FBRUgsTUFBTSxZQUFZLEdBQUcsSUFBSSw0QkFBWSxDQUFDLEdBQUcsRUFBRSxvQkFBb0IsRUFBRTtJQUMvRCxlQUFlO0lBQ2YsVUFBVTtJQUNWLE9BQU87SUFDUCxHQUFHLEVBQUU7UUFDSCxPQUFPLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUI7UUFDeEMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0JBQWtCLElBQUksV0FBVztLQUN0RDtDQUNGLENBQUMsQ0FBQztBQUVILFVBQVUsQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDMUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUV2Qyw4REFBOEQ7QUFDOUQsSUFBSSxvQkFBUSxDQUFDLEdBQUcsRUFBRSxnQkFBZ0IsRUFBRTtJQUNsQyxPQUFPO0lBQ1AsWUFBWTtJQUNaLEdBQUcsRUFBRTtRQUNILE9BQU8sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQjtRQUN4QyxNQUFNLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsSUFBSSxXQUFXO0tBQ3REO0NBQ0YsQ0FBQyxDQUFDO0FBR0gsSUFBSSxtREFBdUIsQ0FBQyxHQUFHLEVBQUUsK0JBQStCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNkayBmcm9tIFwiYXdzLWNkay1saWJcIlxyXG5pbXBvcnQgeyBEQlN0YWNrIH0gZnJvbSBcIi4uL2xpYi9EQnN0YWNrXCI7IC8vIEltcG9ydCB5b3VyIERCU3RhY2tcclxuaW1wb3J0IHsgQVBJU3RhY2sgfSBmcm9tIFwiLi4vbGliL2FwaS1zdGFja1wiOyAvLyBJbXBvcnQgeW91ciBBUElTdGFja1xyXG5pbXBvcnQgeyBGcm9udGVuZERlcGxveW1lbnRTdGFjayB9IGZyb20gXCIuLi9saWIvZnJvbnRlbmQtZGVwbG95bWVudC1zdGFja1wiO1xyXG5pbXBvcnQgeyBPcGVuU2VhcmNoU3RhY2sgfSBmcm9tICcuLi9saWIvb3BlbnNlYXJjaF9zdGFjayc7XHJcbmltcG9ydCB7IEJlZHJvY2tTdGFjayB9IGZyb20gJy4uL2xpYi9iZWRyb2NrX3N0YWNrJztcclxuaW1wb3J0IHsgSW5kZXhTdGFjayB9IGZyb20gJy4uL2xpYi9pbmRleF9zdGFjayc7XHJcblxyXG5jb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xyXG4gXHJcbi8vIENyZWF0ZSB0aGUgREJTdGFja1xyXG5jb25zdCBkYlN0YWNrID0gbmV3IERCU3RhY2soYXBwLCBcIlVuaXR5LURCU3RhY2tcIiwge1xyXG4gIGVudjoge1xyXG4gICAgYWNjb3VudDogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfQUNDT1VOVCxcclxuICAgIHJlZ2lvbjogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfUkVHSU9OIHx8ICd1cy1lYXN0LTEnXHJcbiAgfVxyXG59KTtcclxuIFxyXG5jb25zdCBvcGVuU2VhcmNoU3RhY2sgPSBuZXcgT3BlblNlYXJjaFN0YWNrKGFwcCwgJ1VuaXR5LU9wZW5TZWFyY2hTdGFjaycsIHtcclxuICBlbnY6IHtcclxuICAgIGFjY291bnQ6IHByb2Nlc3MuZW52LkNES19ERUZBVUxUX0FDQ09VTlQsXHJcbiAgICByZWdpb246IHByb2Nlc3MuZW52LkNES19ERUZBVUxUX1JFR0lPTiB8fCAndXMtZWFzdC0xJ1xyXG4gIH1cclxufSk7XHJcbiBcclxuY29uc3QgaW5kZXhTdGFjayA9IG5ldyBJbmRleFN0YWNrKGFwcCwgJ1VuaXR5LUluZGV4U3RhY2snLCB7XHJcbiAgb3BlblNlYXJjaFN0YWNrLFxyXG4gIGVudjoge1xyXG4gICAgYWNjb3VudDogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfQUNDT1VOVCxcclxuICAgIHJlZ2lvbjogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfUkVHSU9OIHx8ICd1cy1lYXN0LTEnXHJcbiAgfVxyXG59KTtcclxuIFxyXG5jb25zdCBiZWRyb2NrU3RhY2sgPSBuZXcgQmVkcm9ja1N0YWNrKGFwcCwgJ1VuaXR5LUJlZHJvY2tTdGFjaycsIHtcclxuICBvcGVuU2VhcmNoU3RhY2ssXHJcbiAgaW5kZXhTdGFjayxcclxuICBkYlN0YWNrLFxyXG4gIGVudjoge1xyXG4gICAgYWNjb3VudDogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfQUNDT1VOVCxcclxuICAgIHJlZ2lvbjogcHJvY2Vzcy5lbnYuQ0RLX0RFRkFVTFRfUkVHSU9OIHx8ICd1cy1lYXN0LTEnXHJcbiAgfVxyXG59KTtcclxuIFxyXG5pbmRleFN0YWNrLmFkZERlcGVuZGVuY3kob3BlblNlYXJjaFN0YWNrKTtcclxuYmVkcm9ja1N0YWNrLmFkZERlcGVuZGVuY3koaW5kZXhTdGFjayk7XHJcbiBcclxuLy8gQ3JlYXRlIHRoZSBBUElTdGFjaywgcGFzc2luZyBpbiB0aGUgREJTdGFjayBhcyBhIGRlcGVuZGVuY3lcclxubmV3IEFQSVN0YWNrKGFwcCwgXCJVbml0eS1BUElTdGFja1wiLCB7XHJcbiAgZGJTdGFjayxcclxuICBiZWRyb2NrU3RhY2ssXHJcbiAgZW52OiB7XHJcbiAgICBhY2NvdW50OiBwcm9jZXNzLmVudi5DREtfREVGQVVMVF9BQ0NPVU5ULFxyXG4gICAgcmVnaW9uOiBwcm9jZXNzLmVudi5DREtfREVGQVVMVF9SRUdJT04gfHwgJ3VzLWVhc3QtMSdcclxuICB9XHJcbn0pO1xyXG5cclxuIFxyXG5uZXcgRnJvbnRlbmREZXBsb3ltZW50U3RhY2soYXBwLCBcIlVuaXR5LUZyb250ZW5kRGVwbG95bWVudFN0YWNrXCIpO1xyXG4iXX0=